# Tabula Rasa Agent - Knowledge-Centered Conversational AI

–ü—Ä–æ—î–∫—Ç AI –∞–≥–µ–Ω—Ç–∞ –∑ –¥–æ–≤–≥–æ—Ç—Ä–∏–≤–∞–ª–æ—é –ø–∞–º'—è—Ç—Ç—é –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω—É **Tabula Rasa: Agent Genesis**.

[English version below](#english-version)

---

## üéØ –û–≥–ª—è–¥ –ø—Ä–æ—î–∫—Ç—É

**Tabula Rasa Agent** - —Ü–µ –∞–≥–µ–Ω—Ç –∑ –Ω—É–ª—å–æ–≤–∏–º–∏ –∑–Ω–∞–Ω–Ω—è–º–∏ –ø—Ä–æ –ø—Ä–µ–¥–º–µ—Ç–Ω—É –æ–±–ª–∞—Å—Ç—å, —è–∫–∏–π –Ω–∞–≤—á–∞—î—Ç—å—Å—è –≤–∏–∫–ª—é—á–Ω–æ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ –¥—ñ–∞–ª–æ–≥.

### –ö–ª—é—á–æ–≤—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **Lapa LLM** - —É–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–Ω–∞ –º–æ–¥–µ–ª—å –Ω–∞ –±–∞–∑—ñ Gemma 12B
- **Graphiti** - —Ç–µ–º–ø–æ—Ä–∞–ª—å–Ω–∏–π –≥—Ä–∞—Ñ –∑–Ω–∞–Ω—å –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ –∞–≥–µ–Ω—Ç–∞
- **LangGraph** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –∞–≥–µ–Ω—Ç—ñ–≤ –∑—ñ —Å—Ç–∞–Ω–æ–º
- **Neo4j** - –≥—Ä–∞—Ñ–æ–≤–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –¥–ª—è knowledge + message references
- **FastAPI** - REST API endpoints
- **Uv** - package manager

### –ö–ª—é—á–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

‚ú® **Tabula Rasa** - –∞–≥–µ–Ω—Ç –ø–æ—á–∏–Ω–∞—î –∑ –Ω—É–ª—å–æ–≤–∏–º–∏ –∑–Ω–∞–Ω–Ω—è–º–∏ –ø—Ä–æ –¥–æ–º–µ–Ω  
üß† **–ì—Ä–∞—Ñ–æ–≤–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è** - –∑–≤'—è–∑–∫–∏ –º—ñ–∂ —Å—É—Ç–Ω–æ—Å—Ç—è–º–∏ —Ç–∞ –∫–æ–Ω—Ü–µ–ø—Ç–∞–º–∏  
üá∫üá¶ **–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞** - –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó  
üîç **–ì—ñ–±—Ä–∏–¥–Ω–∏–π –ø–æ—à—É–∫** - —Å–µ–º–∞–Ω—Ç–∏—á–Ω–∏–π + BM25 + –æ–±—Ö—ñ–¥ –≥—Ä–∞—Ñ—É  
‚è±Ô∏è **–¢–µ–º–ø–æ—Ä–∞–ª—å–Ω—ñ—Å—Ç—å** - –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —á–∞—Å—É –ø–æ–¥—ñ–π  
üîó **References** - –∫–æ–∂–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º—ñ—Å—Ç–∏—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –¥–∂–µ—Ä–µ–ª–∞  
üîÑ **Auto-resolve** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ (–Ω–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–∞–º—ñ–Ω—é—î —Å—Ç–∞—Ä—É)  

---

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### Bidirectional Knowledge Flow

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    USER     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CLASSIFY INTENT               ‚îÇ
‚îÇ   (TEACH or SOLVE)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                  ‚îÇ
       ‚îÇ TEACH            ‚îÇ SOLVE
       ‚ñº                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Extract      ‚îÇ   ‚îÇ Retrieve     ‚îÇ
‚îÇ Facts        ‚îÇ   ‚îÇ Context      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                  ‚îÇ
       ‚ñº                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Check        ‚îÇ   ‚îÇ ReAct        ‚îÇ
‚îÇ Conflicts    ‚îÇ   ‚îÇ Loop         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                  ‚îÇ
       ‚ñº                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Auto-Resolve ‚îÇ   ‚îÇ Generate     ‚îÇ
‚îÇ (new > old)  ‚îÇ   ‚îÇ Answer       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                  ‚îÇ
       ‚ñº                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ Store to     ‚îÇ          ‚îÇ
‚îÇ Graphiti     ‚îÇ          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
       ‚îÇ                  ‚îÇ
       ‚ñº                  ‚ñº
    Response          Response
  + confirmation    + references
```

### Agent Nodes

**TEACH Path (–∞–≥–µ–Ω—Ç –Ω–∞–≤—á–∞—î—Ç—å—Å—è):**
1. `classify` - –≤–∏–∑–Ω–∞—á–∞—î intent (TEACH/SOLVE)
2. `extract_facts` - –≤–∏—Ç—è–≥—É—î structured facts –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
3. `check_conflicts` - –¥–µ—Ç–µ–∫—Ç—É—î –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏ –∑ —ñ—Å–Ω—É—é—á–∏–º–∏ –∑–Ω–∞–Ω–Ω—è–º–∏
4. `auto_resolve` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏–π–º–∞—î –Ω–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é
5. `generate_confirmation` - –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Ä–æ–∑—É–º—ñ–Ω–Ω—è –Ω–∞–≤—á–µ–Ω–æ–≥–æ
6. `store_knowledge` - –∑–±–µ—Ä—ñ–≥–∞—î –≤ Graphiti + Neo4j

**SOLVE Path (–∞–≥–µ–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î):**
1. `classify` - –≤–∏–∑–Ω–∞—á–∞—î intent
2. `retrieve_context` - —à—É–∫–∞—î —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —É –ø–∞–º'—è—Ç—ñ
3. `react_loop` - —ñ—Ç–µ—Ä–∞—Ç–∏–≤–Ω–µ –º—ñ—Ä–∫—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–æ—à—É–∫
4. `generate_answer` - –≥–µ–Ω–µ—Ä—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º–∏ references

---

## üì¶ –í–∏–º–æ–≥–∏

### –°–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–º–æ–≥–∏
- Docker —Ç–∞ Docker Compose
- 16GB+ RAM
- 10GB+ –≤—ñ–ª—å–Ω–æ–≥–æ –º—ñ—Å—Ü—è –Ω–∞ –¥–∏—Å–∫—É

### –ó–æ–≤–Ω—ñ—à–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏
- **vLLM —Å–µ—Ä–≤–µ—Ä** –∑ Lapa LLM (–∑–∞–ø—É—â–µ–Ω–∏–π –æ–∫—Ä–µ–º–æ)
- –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: hosted embeddings API

---

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ .env —Ñ–∞–π–ª

```bash
make env
# –∞–±–æ
cp env.example .env
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ .env

**–ö–†–ò–¢–ò–ß–ù–û:** –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å URL –¥–æ –≤–∞—à–æ–≥–æ vLLM —Å–µ—Ä–≤–µ—Ä–∞:

```bash
# –Ø–∫—â–æ vLLM –∑–∞–ø—É—â–µ–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ host:
VLLM_BASE_URL=http://host.docker.internal:8000/v1

# –Ø–∫—â–æ vLLM –Ω–∞ —ñ–Ω—à–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ:
VLLM_BASE_URL=http://your-server-ip:8000/v1

# –Ü–Ω—à—ñ –≤–∞–∂–ª–∏–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
NEO4J_PASSWORD=password123
LOG_LEVEL=INFO
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —á–µ—Ä–µ–∑ Docker Compose

```bash
# –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç (–≤—Å–µ –≤ –æ–¥–Ω—ñ–π –∫–æ–º–∞–Ω–¥—ñ)
make quick-start

# –ê–±–æ –≤—Ä—É—á–Ω—É:
docker-compose up -d --build
```

**–ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫ –∑–∞–π–º–µ 5-10 —Ö–≤–∏–ª–∏–Ω** (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è ML –º–æ–¥–µ–ª–µ–π –≤ –æ–±—Ä–∞–∑).

### 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏

```bash
# –ß–µ—Ä–µ–∑ Makefile
make health

# –ê–±–æ —á–µ—Ä–µ–∑ curl
curl http://localhost:3000/health
```

**–û—á—ñ–∫—É–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "status": "healthy",
  "timestamp": "2026-01-11T..."
}
```

---

## üì° –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API

### Endpoints

- **API Root**: http://localhost:3000/
- **Swagger UI**: http://localhost:3000/docs
- **Health**: http://localhost:3000/health
- **Text**: POST http://localhost:3000/text
- **Neo4j UI**: http://localhost:7474 (neo4j/password123)

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤

#### –ù–∞–≤—á–∞–Ω–Ω—è –∞–≥–µ–Ω—Ç–∞ (TEACH)

```bash
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{
    "text": "–ó–Ω–∞—á–µ–Ω–Ω—è pi –¥–æ—Ä—ñ–≤–Ω—é—î 3.14",
    "user_id": "test-user"
  }'
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "response": "–ó—Ä–æ–∑—É–º—ñ–≤! –¢–µ–ø–µ—Ä —è –∑–Ω–∞—é —â–æ pi = 3.14. –¶–µ —á–∏—Å–ª–æ–≤–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞.\n\n‚úì –ù–∞–≤—á–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ.",
  "references": ["msg-001"]
}
```

#### –ó–∞–ø–∏—Ç –¥–æ –∞–≥–µ–Ω—Ç–∞ (SOLVE)

```bash
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{
    "text": "–Ø–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è pi?",
    "user_id": "test-user"
  }'
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "response": "–ó–Ω–∞—á–µ–Ω–Ω—è pi –¥–æ—Ä—ñ–≤–Ω—é—î 3.14 [msg-001].",
  "references": ["msg-001"],
  "reasoning": "–ö—Ä–æ–∫ 1: –ü–æ—à—É–∫ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ pi..."
}
```

#### –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (Auto-resolve)

```bash
# –°–ø–æ—á–∞—Ç–∫—É –Ω–∞–≤—á–∞—î–º–æ
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "–°—Ç–æ–ª–∏—Ü—è –£–∫—Ä–∞—ó–Ω–∏ - –ö–∏—ó–≤", "user_id": "test"}'

# –ü–æ—Ç—ñ–º –æ–Ω–æ–≤–ª—é—î–º–æ (–¥–ª—è —Ç–µ—Å—Ç—É)
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "–°—Ç–æ–ª–∏—Ü—è –£–∫—Ä–∞—ó–Ω–∏ - –õ—å–≤—ñ–≤", "user_id": "test"}'
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è):**
```json
{
  "response": "‚úì –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –æ–Ω–æ–≤–ª–µ–Ω–æ\n\n**–ë—É–ª–æ** (msg-001):\n–ö–∏—ó–≤ —î_—Å—Ç–æ–ª–∏—Ü–µ—é –£–∫—Ä–∞—ó–Ω–∏\n\n**–¢–µ–ø–µ—Ä** (msg-002):\n–õ—å–≤—ñ–≤ —î_—Å—Ç–æ–ª–∏—Ü–µ—é –£–∫—Ä–∞—ó–Ω–∏\n\n–Ø –æ–Ω–æ–≤–∏–≤ —Å–≤–æ—ó –∑–Ω–∞–Ω–Ω—è...",
  "references": ["msg-001", "msg-002"]
}
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
graphity_lapa/
‚îú‚îÄ‚îÄ üê≥ Docker
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                    # Multi-stage build –∑ ML –º–æ–¥–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml            # Agent + Neo4j
‚îÇ   ‚îú‚îÄ‚îÄ .dockerignore
‚îÇ   ‚îî‚îÄ‚îÄ env.example
‚îÇ
‚îú‚îÄ‚îÄ üîß Configuration
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py               # Pydantic settings
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logging_config.py
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îÇ
‚îú‚îÄ‚îÄ ü§ñ Agent
‚îÇ   ‚îú‚îÄ‚îÄ agent/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ state.py                  # AgentState TypedDict
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ graph.py                  # LangGraph topology
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ helpers.py                # Utility functions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ nodes/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ classify.py           # Intent classification
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ extract.py            # Fact extraction
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ conflicts.py          # Conflict detection
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auto_resolve.py       # Auto-accept new info
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ resolve.py            # Manual resolution (backup)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ confirm.py            # Confirmation generation
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ store.py              # Knowledge storage
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ retrieve.py           # Context retrieval
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ react.py              # ReAct reasoning
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ generate.py           # Answer generation
‚îÇ
‚îú‚îÄ‚îÄ üîå Clients
‚îÇ   ‚îú‚îÄ‚îÄ clients/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ llm_client.py             # LLM wrapper (Lapa)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ graphiti_client.py        # Graphiti —Å custom LLM
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hosted_embedder.py        # Hosted embeddings
‚îÇ
‚îú‚îÄ‚îÄ üóÑÔ∏è Database
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ neo4j_helpers.py          # Message references store
‚îÇ
‚îú‚îÄ‚îÄ üåê API
‚îÇ   ‚îú‚îÄ‚îÄ app.py                        # FastAPI application
‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ       ‚îú‚îÄ‚îÄ text.py                   # /text endpoint
‚îÇ       ‚îî‚îÄ‚îÄ schemas.py                # Request/Response models
‚îÇ
‚îî‚îÄ‚îÄ üìö Documentation
    ‚îú‚îÄ‚îÄ README.md                     # –¶–µ–π —Ñ–∞–π–ª
    ‚îú‚îÄ‚îÄ QUICKSTART.md                 # –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç (3 –∫–æ–º–∞–Ω–¥–∏)
    ‚îú‚îÄ‚îÄ DOCKER_SETUP.md               # –î–µ—Ç–∞–ª—å–Ω–∏–π Docker setup
    ‚îú‚îÄ‚îÄ TABULA_RASA_IMPLEMENTATION.md # –Ü–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è
    ‚îî‚îÄ‚îÄ TABULA_RASA_TESTING.md        # Testing guide
```

---

## üõ†Ô∏è –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

### –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è (—á–µ—Ä–µ–∑ Makefile)

```bash
make up          # –ó–∞–ø—É—Å—Ç–∏—Ç–∏
make down        # –ó—É–ø–∏–Ω–∏—Ç–∏
make restart     # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
make logs        # –î–∏–≤–∏—Ç–∏—Å—å –ª–æ–≥–∏
make ps          # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤—ñ—Å—ñ–≤
```

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
make health         # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ API
make test-teach     # –¢–µ—Å—Ç –Ω–∞–≤—á–∞–Ω–Ω—è
make test-solve     # –¢–µ—Å—Ç –∑–∞–ø–∏—Ç—É
make check-vllm     # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ vLLM
```

### –†–æ–∑—Ä–æ–±–∫–∞

```bash
make dev-up         # Setup –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏
make dev-rebuild    # Rebuild –±–µ–∑ –∫–µ—à—É
make logs-agent     # –õ–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞
make shell-agent    # Shell –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
```

### UI

```bash
make docs           # –í—ñ–¥–∫—Ä–∏—Ç–∏ API docs
make neo4j-query    # –í—ñ–¥–∫—Ä–∏—Ç–∏ Neo4j Browser
```

**–ü–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥:** `make help`

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### Environment Variables (.env)

```bash
# === LLM Configuration ===
VLLM_BASE_URL=http://host.docker.internal:8000/v1
VLLM_MODEL_NAME=lapa
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=2048

# === Neo4j ===
NEO4J_URI=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password123

# === Embeddings ===
USE_HOSTED_EMBEDDINGS=true  # false –¥–ª—è local
EMBEDDING_MODEL=sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2

# === Graphiti ===
GRAPHITI_SEARCH_LIMIT=10
GRAPHITI_RELEVANCE_THRESHOLD=0.7

# === Logging ===
LOG_LEVEL=INFO  # DEBUG –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è

# === LangSmith (optional) ===
LANGSMITH_API_KEY=your-key
LANGSMITH_TRACING_V2=false
```

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –ë–∞–∑–æ–≤–µ –Ω–∞–≤—á–∞–Ω–Ω—è

```bash
# 1. –ù–∞–≤—á–∏—Ç–∏ —Ñ–∞–∫—Ç
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "–£ —Å–∏—Å—Ç–µ–º—ñ Alpha –∫–æ–º–∞–Ω–¥–∞ –º–∞—î —Ñ–æ—Ä–º–∞—Ç: –¥—ñ—è –æ–±'\''—î–∫—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏", "user_id": "test"}'

# 2. –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –Ω–∞–≤—á–µ–Ω–µ
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "–°—Ç–≤–æ—Ä–∏ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ñ–∞–π–ª—É test.txt", "user_id": "test"}'

# –û—á—ñ–∫—É—î—Ç—å—Å—è: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–∞–≤—á–µ–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∑ references
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: Auto-resolve –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤

```bash
# 1. –ù–∞–≤—á–∏—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "–ó–Ω–∞—á–µ–Ω–Ω—è pi –¥–æ—Ä—ñ–≤–Ω—é—î 3.14", "user_id": "test"}'

# 2. –û–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "–ó–Ω–∞—á–µ–Ω–Ω—è pi –¥–æ—Ä—ñ–≤–Ω—é—î 4", "user_id": "test"}'

# –û—á—ñ–∫—É—î—Ç—å—Å—è: –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ –Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –í–∏–∑–Ω–∞–Ω–Ω—è gaps

```bash
# –ó–∞–ø–∏—Ç–∞—Ç–∏ –ø—Ä–æ —â–æ—Å—å –Ω–µ–Ω–∞–≤—á–µ–Ω–µ
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "–©–æ —Ç–∞–∫–µ Python?", "user_id": "test"}'

# –û—á—ñ–∫—É—î—Ç—å—Å—è: "–ù–∞ –∂–∞–ª—å, —è –Ω–µ –º–∞—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ Python..."
```

**–î–µ—Ç–∞–ª—å–Ω–∏–π testing guide:** [TABULA_RASA_TESTING.md](TABULA_RASA_TESTING.md)

---

## üîß Troubleshooting

### Agent –Ω–µ —Å—Ç–∞—Ä—Ç—É—î

```bash
make logs-agent  # –î–∏–≤–∏–º–æ—Å—å –ª–æ–≥–∏
make dev-rebuild  # Rebuild –±–µ–∑ –∫–µ—à—É
```

### vLLM –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π

```bash
make check-vllm  # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞
# –í–∏–ø—Ä–∞–≤—Ç–µ VLLM_BASE_URL –≤ .env
make restart-agent
```

### Neo4j –Ω–µ —Å—Ç–∞—Ä—Ç—É—î

```bash
make logs-neo4j  # –õ–æ–≥–∏
sleep 30 && make ps  # –î–∞—î–º–æ –±—ñ–ª—å—à–µ —á–∞—Å—É (–¥–æ 60 —Å–µ–∫)
```

### –ü–æ—Ä—Ç –∑–∞–π–Ω—è—Ç–∏–π

–£ `docker-compose.yml`:
```yaml
agent:
  ports:
    - "8080:3000"  # –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —ñ–Ω—à–∏–π –ø–æ—Ä—Ç
```

**–î–µ—Ç–∞–ª—å–Ω–∏–π troubleshooting:** [DOCKER_SETUP.md](docs/DOCKER_SETUP.mdUP.md)

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- **[QUICKSTART.md](QUICKSTART.md)** - —à–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –∑–∞ 3 –∫–æ–º–∞–Ω–¥–∏
- **[DOCKER_SETUP.md](docs/DOCKER_SETUP.mdUP.md)** - –¥–µ—Ç–∞–ª—å–Ω–∏–π Docker setup
- **[DOCKER_DEPLOYMENT.md](docs/DOCKER_DEPLOYMENT.mdNT.md)** - production deployment
- **[TABULA_RASA_IMPLEMENTATION.md](TABULA_RASA_IMPLEMENTATION.md)** - —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è –∑–º—ñ–Ω
- **[TABULA_RASA_TESTING.md](TABULA_RASA_TESTING.md)** - testing scenarios

---

## üéì –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π
- [Graphiti GitHub](https://github.com/getzep/graphiti)
- [LangGraph Docs](https://langchain-ai.github.io/langgraph/)
- [vLLM Documentation](https://docs.vllm.ai/)
- [Lapa LLM –Ω–∞ HuggingFace](https://huggingface.co/lapa-llm)

### –•–∞–∫–∞—Ç–æ–Ω
- [Tabula Rasa: Agent Genesis Task](https://www.notion.so/Tabula-Rasa-Agent-Genesis-Lapathon-Task-2dcb51a2f1a880e6a31ddcb7ecb84e00)

---

## ‚ú® –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ Tabula Rasa Agent

### 1. –ù—É–ª—å–æ–≤—ñ –∑–Ω–∞–Ω–Ω—è –ø—Ä–æ –¥–æ–º–µ–Ω
- ‚úÖ –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î pretrained knowledge
- ‚úÖ –ù–∞–≤—á–∞—î—Ç—å—Å—è –≤–∏–∫–ª—é—á–Ω–æ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚úÖ –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π (–ø—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–∏–º –¥–æ–º–µ–Ω–æ–º)

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤
- ‚úÖ –ù–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–º—ñ–Ω—é—î —Å—Ç–∞—Ä—É (pi=4 > pi=3.14)
- ‚úÖ –ü—Ä–æ–∑–æ—Ä–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- ‚úÖ References –¥–æ –æ–±–æ—Ö –¥–∂–µ—Ä–µ–ª (—Å—Ç–∞—Ä–µ + –Ω–æ–≤–µ)

### 3. –û–±–æ–≤'—è–∑–∫–æ–≤—ñ references
- ‚úÖ –ö–æ–∂–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º—ñ—Å—Ç–∏—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è [msg-XXX]
- ‚úÖ –¢–æ—á–Ω–µ –º–∞–ø—É–≤–∞–Ω–Ω—è –¥–∂–µ—Ä–µ–ª (–Ω–µ —ñ–Ω–¥–µ–∫—Å–∏!)
- ‚úÖ –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏—Ö –∑–Ω–∞–Ω—å

### 4. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è
- ‚úÖ –ù–µ –ø—Ä–æ—Å—Ç–æ "–∑–∞–ø–∞–º'—è—Ç–∞–≤", –∞ –ø–æ–∫–∞–∑—É—î —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
- ‚úÖ –†—ñ–∑–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç—É
- ‚úÖ –í–∏–∑–Ω–∞—î gaps —É –∑–Ω–∞–Ω–Ω—è—Ö

### 5. Epistemic awareness
- ‚úÖ Confidence scores –¥–ª—è —Ñ–∞–∫—Ç—ñ–≤
- ‚úÖ –î–µ—Ç–µ–∫—Ü—ñ—è 5 —Ç–∏–ø—ñ–≤ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤
- ‚úÖ Reasoning trace –¥–ª—è accountability

---

## üêõ Known Issues

1. **Reranker –º–æ–¥–µ–ª—å** - 2.27 GB, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å Docker build
   - –ü–µ—Ä—à–∏–π build –∑–∞–π–º–∞—î ~5-10 —Ö–≤–∏–ª–∏–Ω
   - –ú–æ–¥–µ–ª—å –≤–∫–ª—é—á–µ–Ω–∞ –≤ –æ–±—Ä–∞–∑ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —Å—Ç–∞—Ä—Ç—É

2. **Embeddings** - –ø–µ—Ä—à–∏–π –∑–∞–ø–∏—Ç –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω–∏–º (~5-10 —Å–µ–∫)
   - sentence-transformers —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ
   - –ù–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏ —à–≤–∏–¥–∫—ñ

3. **Neo4j startup** - –º–æ–∂–µ –∑–∞–π–º–∞—Ç–∏ –¥–æ 60 —Å–µ–∫—É–Ω–¥
   - Healthcheck —á–µ–∫–∞—î –ø–æ–∫–∏ Neo4j –≥–æ—Ç–æ–≤–∏–π
   - Docker Compose –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–µ–∫–∞—î —á–µ—Ä–µ–∑ `depends_on`

---

## ü§ù Contributing

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω—É. –î–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω—å:

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
2. –°—Ç–≤–æ—Ä—ñ—Ç—å feature branch
3. Commit –∑–º—ñ–Ω–∏
4. Push –≤ branch
5. –°—Ç–≤–æ—Ä—ñ—Ç—å Pull Request

---

## üìÑ License

MIT License - –¥–∏–≤. LICENSE —Ñ–∞–π–ª –¥–ª—è –¥–µ—Ç–∞–ª–µ–π

---

## üë• Authors

- –•–∞–∫–∞—Ç–æ–Ω –ø—Ä–æ—î–∫—Ç –¥–ª—è **Tabula Rasa: Agent Genesis**
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó: Lapa LLM, Graphiti, LangGraph, Neo4j, FastAPI

---

## üéâ –ü–æ–¥—è–∫–∏

- –ö–æ–º–∞–Ω–¥—ñ **Lapa LLM** –∑–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫—É –º–æ–¥–µ–ª—å
- **Zep** –∑–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Graphiti
- **LangChain** –∑–∞ LangGraph
- –û—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä–∞–º **Lapathon** –∑–∞ –º–æ—Ç–∏–≤–∞—Ü—ñ—é!

---

# English Version

## üéØ Project Overview

**Tabula Rasa Agent** is a knowledge-centered conversational AI agent that starts with zero knowledge about any domain and learns exclusively from user interactions.

### Key Features

‚ú® **Tabula Rasa** - agent starts with zero domain knowledge  
üß† **Graph Memory** - stores knowledge in temporal knowledge graph  
üá∫üá¶ **Ukrainian Language** - optimized for Ukrainian using Lapa LLM  
üîç **Hybrid Search** - semantic + BM25 + graph traversal  
‚è±Ô∏è **Temporal** - tracks time of events and facts  
üîó **References** - every response includes source citations  
üîÑ **Auto-resolve** - automatically updates conflicting information  

### Technologies

- **Lapa LLM** - Ukrainian language model (Gemma 12B based)
- **Graphiti** - Temporal knowledge graph
- **LangGraph** - Agent orchestration framework
- **Neo4j** - Graph database
- **FastAPI** - REST API

---

## üöÄ Quick Start

### 1. Setup environment

```bash
make env
nano .env  # Set VLLM_BASE_URL
```

### 2. Start with Docker

```bash
make quick-start
```

### 3. Test API

```bash
curl http://localhost:3000/health
```

**Documentation:**
- Swagger UI: http://localhost:3000/docs
- Neo4j Browser: http://localhost:7474

---

## üì° API Examples

### Teach the agent

```bash
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "The value of pi equals 3.14", "user_id": "test"}'
```

### Query the agent

```bash
curl -X POST http://localhost:3000/text \
  -H "Content-Type: application/json" \
  -d '{"text": "What is the value of pi?", "user_id": "test"}'
```

Response includes `references` with source message UIDs.

---

## üìö Documentation

- **[QUICKSTART.md](QUICKSTART.md)** - 3-command quick start
- **[DOCKER_SETUP.md](docs/DOCKER_SETUP.mdUP.md)** - detailed Docker setup
- **[TABULA_RASA_TESTING.md](TABULA_RASA_TESTING.md)** - testing scenarios

---

## üõ†Ô∏è Commands

```bash
make help          # Show all commands
make up            # Start services
make logs          # View logs
make test-teach    # Test teaching
make test-solve    # Test querying
```

---

## ‚öôÔ∏è Configuration

Edit `.env` file:

```bash
VLLM_BASE_URL=http://host.docker.internal:8000/v1
NEO4J_PASSWORD=password123
LOG_LEVEL=INFO
```

---

## üéØ Key Principles

### Tabula Rasa
- No pretrained domain knowledge
- Learns only from user
- Universal (works with any domain)

### Auto-resolve Conflicts
- New information automatically replaces old
- pi=4 replaces pi=3.14
- Transparent notification with references

### Mandatory References
- Every response cites sources [msg-XXX]
- Exact source mapping (not indices)
- Verification of used knowledge

---

## üìÑ License

MIT License

---

**Ready to start!** üöÄ

```bash
make quick-start
```
